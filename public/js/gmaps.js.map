{"version":3,"sources":["gmaps.coffee"],"names":[],"mappings":"AAAA;AAAA,MAAA,yLAAA;;AAAA,EAAA,UAAA,GAAa,SAAA,GAAA;AACX,QAAA,wBAAA;AAAA,IAAA,SAAA,GAAY,QAAQ,CAAC,cAAT,CAAwB,gBAAxB,CAAZ,CAAA;AAAA,IACA,aAAA,GAAgB,QAAQ,CAAC,cAAT,CAAwB,qBAAxB,CADhB,CAAA;AAGA,IAAA,IAA4B,iBAA5B;AAAA,MAAA,cAAA,CAAe,SAAf,CAAA,CAAA;KAHA;AAIA,IAAA,IAAuD,qBAAvD;aAAA,sBAAA,CAAuB,aAAvB,EAAsC,SAAS,CAAC,GAAhD,EAAA;KALW;EAAA,CAAb,CAAA;;AAAA,EAOA,cAAA,GAAiB,SAAC,SAAD,GAAA;AACf,QAAA,iBAAA;AAAA,IAAA,OAAA,GACE;AAAA,MAAA,IAAA,EAAM,EAAN;AAAA,MACA,MAAA,EAAQ;QACN;AAAA,UAAA,WAAA,EAAa,KAAb;AAAA,UACA,WAAA,EAAa,QADb;AAAA,UAEA,OAAA,EAAS;YAAC;AAAA,cAAA,UAAA,EAAY,KAAZ;aAAD;WAFT;SADM;OADR;KADF,CAAA;AAQA,IAAA,IAAG,kCAAH;AACE,MAAA,QAAA,GAAW,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,KAA3B,CAAiC,GAAjC,CAAX,CAAA;AAAA,MACA,OAAO,CAAC,QAAR,GAAuB,IAAA,MAAM,CAAC,IAAI,CAAC,MAAZ,CAAmB,QAAS,CAAA,CAAA,CAA5B,EAAgC,QAAS,CAAA,CAAA,CAAzC,CADvB,CADF;KARA;AAAA,IAYA,SAAS,CAAC,GAAV,GAAoB,IAAA,MAAM,CAAC,IAAI,CAAC,GAAZ,CAAgB,SAAhB,EAA2B,OAA3B,CAZpB,CAAA;AAAA,IAaA,SAAS,CAAC,MAAV,GAAuB,IAAA,MAAM,CAAC,IAAI,CAAC,MAAZ,CACrB;AAAA,MAAA,GAAA,EAAK,SAAS,CAAC,GAAf;AAAA,MACA,WAAA,EAAiB,IAAA,MAAM,CAAC,IAAI,CAAC,KAAZ,CAAkB,CAAlB,EAAqB,CAAA,EAArB,CADjB;KADqB,CAbvB,CAAA;AAAA,IAgBA,SAAS,CAAC,UAAV,GAAuB,GAAA,CAAA,MAAU,CAAC,IAAI,CAAC,UAhBvC,CAAA;AAkBA,IAAA,IAAgC,SAAS,CAAC,WAA1C;aAAA,cAAA,CAAe,SAAS,CAAC,GAAzB,EAAA;KAnBe;EAAA,CAPjB,CAAA;;AAAA,EA4BA,cAAA,GAAiB,SAAC,GAAD,GAAA;WACf,SAAS,CAAC,WAAW,CAAC,kBAAtB,CAAyC,SAAC,QAAD,GAAA;AACvC,UAAA,QAAA;AAAA,MAAA,QAAA,GAAe,IAAA,MAAM,CAAC,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAC,MAAM,CAAC,QAAnC,EAA6C,QAAQ,CAAC,MAAM,CAAC,SAA7D,CAAf,CAAA;AAAA,MACA,GAAG,CAAC,SAAJ,CAAc,QAAd,CADA,CAAA;aAEA,YAAA,CAAa,QAAb,EAHuC;IAAA,CAAzC,EADe;EAAA,CA5BjB,CAAA;;AAAA,EAkCA,sBAAA,GAAyB,SAAC,aAAD,EAAgB,GAAhB,GAAA;AACvB,QAAA,YAAA;AAAA,IAAA,YAAA,GAAmB,IAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,YAAnB,CAAgC,aAAhC,CAAnB,CAAA;AAEA,IAAA,IAA2C,WAA3C;aAAA,qBAAA,CAAsB,YAAtB,EAAoC,GAApC,EAAA;KAHuB;EAAA,CAlCzB,CAAA;;AAAA,EAuCA,qBAAA,GAAwB,SAAC,YAAD,EAAe,GAAf,GAAA;AACtB,IAAA,YAAY,CAAC,MAAb,CAAoB,QAApB,EAA8B,GAA9B,CAAA,CAAA;WAEA,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,WAAlB,CAA8B,YAA9B,EAA4C,eAA5C,EAA6D,YAAA,CAAa,YAAb,CAA7D,EAHsB;EAAA,CAvCxB,CAAA;;AAAA,EA4CA,YAAA,GAAe,SAAC,YAAD,GAAA;WAAkB,SAAA,GAAA;AAC/B,UAAA,KAAA;AAAA,MAAA,mBAAA,CAAA,CAAA,CAAA;AAAA,MAEA,KAAA,GAAQ,YAAY,CAAC,QAAb,CAAA,CAFR,CAAA;AAGA,MAAA,IAAU,CAAA,KAAM,CAAC,QAAjB;AAAA,cAAA,CAAA;OAHA;AAAA,MAKA,WAAA,CAAY,KAAZ,CALA,CAAA;AAAA,MAMA,YAAA,CAAa,KAAK,CAAC,QAAQ,CAAC,QAA5B,CANA,CAAA;AAAA,MAOA,cAAA,CAAe,KAAf,EAAsB,SAAS,CAAC,MAAhC,CAPA,CAAA;aAQA,gBAAA,CAAiB,KAAjB,EAT+B;IAAA,EAAlB;EAAA,CA5Cf,CAAA;;AAAA,EAuDA,mBAAA,GAAsB,SAAA,GAAA;AACpB,IAAA,SAAS,CAAC,UAAU,CAAC,KAArB,CAAA,CAAA,CAAA;WACA,SAAS,CAAC,MAAM,CAAC,UAAjB,CAA4B,KAA5B,EAFoB;EAAA,CAvDtB,CAAA;;AAAA,EA2DA,WAAA,GAAc,SAAC,KAAD,GAAA;AACZ,IAAA,IAAG,KAAK,CAAC,QAAQ,CAAC,QAAlB;aACE,SAAS,CAAC,GAAG,CAAC,SAAd,CAAwB,KAAK,CAAC,QAAQ,CAAC,QAAvC,EADF;KAAA,MAAA;AAGE,MAAA,SAAS,CAAC,GAAG,CAAC,SAAd,CAAwB,KAAK,CAAC,QAAQ,CAAC,QAAvC,CAAA,CAAA;aACA,SAAS,CAAC,GAAG,CAAC,OAAd,CAAsB,EAAtB,EAJF;KADY;EAAA,CA3Dd,CAAA;;AAAA,EAkEA,YAAA,GAAe,SAAC,QAAD,GAAA;AACb,IAAA,SAAS,CAAC,MAAM,CAAC,WAAjB,CAA6B,QAA7B,CAAA,CAAA;WACA,SAAS,CAAC,MAAM,CAAC,UAAjB,CAA4B,IAA5B,EAFa;EAAA,CAlEf,CAAA;;AAAA,EAsEA,cAAA,GAAiB,SAAC,KAAD,EAAQ,MAAR,GAAA;AACf,QAAA,OAAA;AAAA,IAAA,OAAA,GAAU,CACP,KAAK,CAAC,kBAAmB,CAAA,CAAA,CAAzB,IAA+B,KAAK,CAAC,kBAAmB,CAAA,CAAA,CAAE,CAAC,UAA3D,IAAyE,EADlE,EAEP,KAAK,CAAC,kBAAmB,CAAA,CAAA,CAAzB,IAA+B,KAAK,CAAC,kBAAmB,CAAA,CAAA,CAAE,CAAC,UAA3D,IAAyE,EAFlE,EAGP,KAAK,CAAC,kBAAmB,CAAA,CAAA,CAAzB,IAA+B,KAAK,CAAC,kBAAmB,CAAA,CAAA,CAAE,CAAC,UAA3D,IAAyE,EAHlE,CAIT,CAAC,IAJQ,CAIH,GAJG,CAAV,CAAA;AAAA,IAMA,SAAS,CAAC,UAAU,CAAC,UAArB,CAAgC,eAAA,GAAkB,KAAK,CAAC,IAAxB,GAA+B,eAA/B,GAAiD,OAAjF,CANA,CAAA;WAOA,SAAS,CAAC,UAAU,CAAC,IAArB,CAA0B,SAAS,CAAC,GAApC,EAAyC,MAAzC,EARe;EAAA,CAtEjB,CAAA;;AAAA,EAgFA,gBAAA,GAAmB,SAAC,KAAD,GAAA;AACjB,QAAA,sBAAA;AAAA;AAAA,SAAA,qCAAA;yBAAA;AACE,MAAA,IAAG,SAAS,CAAC,KAAK,CAAC,OAAhB,CAAwB,aAAxB,CAAA,KAA0C,CAAA,CAA7C;AACE,QAAA,QAAQ,CAAC,cAAT,CAAwB,aAAxB,CAAsC,CAAC,YAAvC,CAAoD,OAApD,EAA6D,SAAS,CAAC,UAAvE,CAAA,CADF;OADF;AAAA,KAAA;AAAA,IAGA,QAAQ,CAAC,cAAT,CAAwB,gBAAxB,CAAyC,CAAC,YAA1C,CAAuD,OAAvD,EAAgE,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAxB,CAAA,CAAhE,CAHA,CAAA;AAAA,IAIA,QAAQ,CAAC,cAAT,CAAwB,iBAAxB,CAA0C,CAAC,YAA3C,CAAwD,OAAxD,EAAiE,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAxB,CAAA,CAAjE,CAJA,CAAA;WAKA,QAAQ,CAAC,cAAT,CAAwB,gBAAxB,CAAyC,CAAC,YAA1C,CAAuD,OAAvD,EAAgE,KAAK,CAAC,QAAtE,EANiB;EAAA,CAhFnB,CAAA;;AAAA,EAwFA,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,cAAlB,CAAiC,MAAjC,EAAyC,MAAzC,EAAiD,UAAjD,CAxFA,CAAA;AAAA","file":"gmaps.js","sourceRoot":"/source/","sourcesContent":["initialize = ->\r\n  container = document.getElementById 'maps-container'\r\n  locationField = document.getElementById 'field-maps-location'\r\n\r\n  initializeMaps container if container?\r\n  initializeAutoComplete locationField, koolbeans.map if locationField?\r\n\r\ninitializeMaps = (container) ->\r\n  options =\r\n    zoom: 15\r\n    styles: [\r\n      featureType: \"poi\"\r\n      elementType: \"labels\"\r\n      stylers: [visibility: \"off\"]\r\n    ]\r\n\r\n  if container.dataset.position?\r\n    position = container.dataset.position.split ','\r\n    options.position = new google.maps.LatLng position[0], position[1]\r\n\r\n  koolbeans.map = new google.maps.Map container, options\r\n  koolbeans.marker = new google.maps.Marker\r\n    map: koolbeans.map\r\n    anchorPoint: new google.maps.Point 0, -29\r\n  koolbeans.infoWindow = new google.maps.InfoWindow\r\n\r\n  useGeoLocation koolbeans.map if navigator.geolocation\r\n\r\nuseGeoLocation = (map) ->\r\n  navigator.geolocation.getCurrentPosition (position) ->\r\n    location = new google.maps.LatLng(position.coords.latitude, position.coords.longitude)\r\n    map.setCenter location\r\n    moveMarkerTo location\r\n\r\ninitializeAutoComplete = (locationField, map) ->\r\n  autoComplete = new google.maps.places.Autocomplete locationField\r\n\r\n  bindMapToAutoComplete autoComplete, map if map?\r\n\r\nbindMapToAutoComplete = (autoComplete, map) ->\r\n  autoComplete.bindTo 'bounds', map\r\n\r\n  google.maps.event.addListener autoComplete, 'place_changed', placeChanged(autoComplete)\r\n\r\nplaceChanged = (autoComplete) -> () ->\r\n  hideMarkerAndWindow()\r\n\r\n  place = autoComplete.getPlace()\r\n  return if !place.geometry\r\n\r\n  centerMapOn place\r\n  moveMarkerTo place.geometry.location\r\n  openInfoWindow place, koolbeans.marker\r\n  changeFormFields place\r\n\r\nhideMarkerAndWindow = () ->\r\n  koolbeans.infoWindow.close();\r\n  koolbeans.marker.setVisible(false);\r\n\r\ncenterMapOn = (place) ->\r\n  if place.geometry.viewport\r\n    koolbeans.map.fitBounds place.geometry.viewport\r\n  else\r\n    koolbeans.map.setCenter place.geometry.location\r\n    koolbeans.map.setZoom 17\r\n\r\nmoveMarkerTo = (position) ->\r\n  koolbeans.marker.setPosition position\r\n  koolbeans.marker.setVisible true\r\n\r\nopenInfoWindow = (place, marker) ->\r\n  address = [\r\n    (place.address_components[0] && place.address_components[0].short_name || ''),\r\n    (place.address_components[1] && place.address_components[1].short_name || ''),\r\n    (place.address_components[2] && place.address_components[2].short_name || '')\r\n  ].join(' ')\r\n\r\n  koolbeans.infoWindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);\r\n  koolbeans.infoWindow.open(koolbeans.map, marker);\r\n\r\nchangeFormFields = (place) ->\r\n  for component in place.address_components\r\n    if component.types.indexOf('postal_code') != -1\r\n      document.getElementById('postal_code').setAttribute 'value', component.short_name\r\n  document.getElementById('latitude-field').setAttribute 'value', place.geometry.location.lat()\r\n  document.getElementById('longitude-field').setAttribute 'value', place.geometry.location.lng()\r\n  document.getElementById('place-id-field').setAttribute 'value', place.place_id\r\n\r\ngoogle.maps.event.addDomListener window, 'load', initialize\r\n"]}